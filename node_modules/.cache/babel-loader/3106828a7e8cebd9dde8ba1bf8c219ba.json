{"ast":null,"code":"var _this = this,\n    _jsxFileName = \"/Users/suho/TeamProject/Spring/projectFinal/tripass/react/src/webapp/usr/components/OAuth2RedirectHandler.jsx\";\n\nimport axios from 'axios';\nimport React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { Redirect } from 'react-router';\nimport { login } from 'webapp/_actions';\n\nvar getUrlParameter = function getUrlParameter(name, search) {\n  name = name.replace(/[\\[]/, '\\\\[').replace(/[\\]]/, '\\\\]');\n  var regex = new RegExp('[\\\\?&]' + name + '=([^&#]*)');\n  var results = regex.exec(search);\n  return results === null ? '' : decodeURIComponent(results[1].replace(/\\+/g, ' '));\n};\n\nexport default (function (_ref) {\n  var location = _ref.location;\n  var token = getUrlParameter('token', location.search);\n  var error = getUrlParameter('error', location.search);\n  var dispatch = useDispatch();\n  var URL = process.env.REACT_APP_API_URL;\n\n  if (token) {\n    localStorage.setItem('accessToken', token);\n    axios.get(\"\".concat(URL, \"/user/one\"), {\n      headers: {\n        Authorization: 'Bearer ' + localStorage.getItem('accessToken')\n      }\n    }).then(function (resp) {\n      return dispatch(login(resp.data));\n    });\n    return /*#__PURE__*/React.createElement(Redirect, {\n      to: {\n        pathname: \"/\",\n        state: {\n          from: location\n        }\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 16\n      }\n    });\n  } else {\n    return /*#__PURE__*/React.createElement(Redirect, {\n      to: {\n        pathname: \"/login\",\n        state: {\n          from: location,\n          error: error\n        }\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 16\n      }\n    });\n  }\n});","map":{"version":3,"sources":["/Users/suho/TeamProject/Spring/projectFinal/tripass/react/src/webapp/usr/components/OAuth2RedirectHandler.jsx"],"names":["axios","React","useDispatch","Redirect","login","getUrlParameter","name","search","replace","regex","RegExp","results","exec","decodeURIComponent","location","token","error","dispatch","URL","process","env","REACT_APP_API_URL","localStorage","setItem","get","headers","Authorization","getItem","then","resp","data","pathname","state","from"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,QAAT,QAAyB,cAAzB;AACA,SAASC,KAAT,QAAsB,iBAAtB;;AAEA,IAAMC,eAAe,GAAE,SAAjBA,eAAiB,CAACC,IAAD,EAAMC,MAAN,EAAiB;AACpCD,EAAAA,IAAI,GAAGA,IAAI,CAACE,OAAL,CAAa,MAAb,EAAqB,KAArB,EAA4BA,OAA5B,CAAoC,MAApC,EAA4C,KAA5C,CAAP;AACA,MAAIC,KAAK,GAAG,IAAIC,MAAJ,CAAW,WAAWJ,IAAX,GAAkB,WAA7B,CAAZ;AAEA,MAAIK,OAAO,GAAGF,KAAK,CAACG,IAAN,CAAWL,MAAX,CAAd;AACA,SAAOI,OAAO,KAAK,IAAZ,GAAmB,EAAnB,GAAwBE,kBAAkB,CAACF,OAAO,CAAC,CAAD,CAAP,CAAWH,OAAX,CAAmB,KAAnB,EAA0B,GAA1B,CAAD,CAAjD;AACH,CAND;;AAQA,gBAAe,gBAAc;AAAA,MAAZM,QAAY,QAAZA,QAAY;AACzB,MAAMC,KAAK,GAAGV,eAAe,CAAC,OAAD,EAASS,QAAQ,CAACP,MAAlB,CAA7B;AACA,MAAMS,KAAK,GAAGX,eAAe,CAAC,OAAD,EAASS,QAAQ,CAACP,MAAlB,CAA7B;AACA,MAAMU,QAAQ,GAAGf,WAAW,EAA5B;AACA,MAAMgB,GAAG,GAAGC,OAAO,CAACC,GAAR,CAAYC,iBAAxB;;AAEA,MAAGN,KAAH,EAAS;AACLO,IAAAA,YAAY,CAACC,OAAb,CAAqB,aAArB,EAAoCR,KAApC;AACAf,IAAAA,KAAK,CAACwB,GAAN,WAAaN,GAAb,gBAA4B;AACxBO,MAAAA,OAAO,EAAC;AACJC,QAAAA,aAAa,EAAC,YAAWJ,YAAY,CAACK,OAAb,CAAqB,aAArB;AADrB;AADgB,KAA5B,EAIGC,IAJH,CAIQ,UAAAC,IAAI;AAAA,aAAEZ,QAAQ,CAACb,KAAK,CAACyB,IAAI,CAACC,IAAN,CAAN,CAAV;AAAA,KAJZ;AAKA,wBAAO,oBAAC,QAAD;AAAU,MAAA,EAAE,EAAE;AACjBC,QAAAA,QAAQ,EAAE,GADO;AAEjBC,QAAAA,KAAK,EAAE;AAAEC,UAAAA,IAAI,EAAEnB;AAAR;AAFU,OAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AAIH,GAXD,MAWK;AACD,wBAAO,oBAAC,QAAD;AAAU,MAAA,EAAE,EAAE;AACjBiB,QAAAA,QAAQ,EAAE,QADO;AAEjBC,QAAAA,KAAK,EAAE;AACHC,UAAAA,IAAI,EAAEnB,QADH;AAEHE,UAAAA,KAAK,EAAEA;AAFJ;AAFU,OAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AAOH;AACJ,CA1BD","sourcesContent":["import axios from 'axios';\nimport React from 'react'\nimport { useDispatch } from 'react-redux';\nimport { Redirect } from 'react-router'\nimport { login } from 'webapp/_actions';\n\nconst getUrlParameter= (name,search) => {\n    name = name.replace(/[\\[]/, '\\\\[').replace(/[\\]]/, '\\\\]');\n    var regex = new RegExp('[\\\\?&]' + name + '=([^&#]*)');\n\n    var results = regex.exec(search);\n    return results === null ? '' : decodeURIComponent(results[1].replace(/\\+/g, ' '));\n}\n\nexport default ({location})=>{\n    const token = getUrlParameter('token',location.search);\n    const error = getUrlParameter('error',location.search);\n    const dispatch = useDispatch()\n    const URL = process.env.REACT_APP_API_URL\n\n    if(token){\n        localStorage.setItem('accessToken', token)\n        axios.get(`${URL}/user/one`,{\n            headers:{\n                Authorization:'Bearer '+ localStorage.getItem('accessToken')\n            }\n        }).then(resp=>dispatch(login(resp.data)))\n        return <Redirect to={{\n            pathname: \"/\",\n            state: { from: location }\n        }}/>\n    }else{\n        return <Redirect to={{\n            pathname: \"/login\",\n            state: { \n                from: location,\n                error: error \n            }\n        }}/>\n    }\n}"]},"metadata":{},"sourceType":"module"}