{"ast":null,"code":"import axios from'axios';import React from'react';import{useDispatch}from'react-redux';import{Redirect}from'react-router';import{login}from'webapp/_actions';var getUrlParameter=function getUrlParameter(name,search){name=name.replace(/[\\[]/,'\\\\[').replace(/[\\]]/,'\\\\]');var regex=new RegExp('[\\\\?&]'+name+'=([^&#]*)');var results=regex.exec(search);return results===null?'':decodeURIComponent(results[1].replace(/\\+/g,' '));};export default(function(_ref){var location=_ref.location;var token=getUrlParameter('token',location.search);var error=getUrlParameter('error',location.search);var dispatch=useDispatch();var URL=process.env.REACT_APP_API_URL;if(token){localStorage.setItem('accessToken',token);axios.get(\"\".concat(URL,\"/user/one\"),{headers:{Authorization:'Bearer '+localStorage.getItem('accessToken')}}).then(function(resp){return dispatch(login(resp.data));});return/*#__PURE__*/React.createElement(Redirect,{to:{pathname:\"/\",state:{from:location}}});}else{return/*#__PURE__*/React.createElement(Redirect,{to:{pathname:\"/login\",state:{from:location,error:error}}});}});","map":{"version":3,"sources":["/Users/suho/TeamProject/Spring/projectFinal/tripass/react/src/webapp/usr/components/OAuth2RedirectHandler.jsx"],"names":["axios","React","useDispatch","Redirect","login","getUrlParameter","name","search","replace","regex","RegExp","results","exec","decodeURIComponent","location","token","error","dispatch","URL","process","env","REACT_APP_API_URL","localStorage","setItem","get","headers","Authorization","getItem","then","resp","data","pathname","state","from"],"mappings":"AAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OAASC,QAAT,KAAyB,cAAzB,CACA,OAASC,KAAT,KAAsB,iBAAtB,CAEA,GAAMC,CAAAA,eAAe,CAAE,QAAjBA,CAAAA,eAAiB,CAACC,IAAD,CAAMC,MAAN,CAAiB,CACpCD,IAAI,CAAGA,IAAI,CAACE,OAAL,CAAa,MAAb,CAAqB,KAArB,EAA4BA,OAA5B,CAAoC,MAApC,CAA4C,KAA5C,CAAP,CACA,GAAIC,CAAAA,KAAK,CAAG,GAAIC,CAAAA,MAAJ,CAAW,SAAWJ,IAAX,CAAkB,WAA7B,CAAZ,CAEA,GAAIK,CAAAA,OAAO,CAAGF,KAAK,CAACG,IAAN,CAAWL,MAAX,CAAd,CACA,MAAOI,CAAAA,OAAO,GAAK,IAAZ,CAAmB,EAAnB,CAAwBE,kBAAkB,CAACF,OAAO,CAAC,CAAD,CAAP,CAAWH,OAAX,CAAmB,KAAnB,CAA0B,GAA1B,CAAD,CAAjD,CACH,CAND,CAQA,eAAe,cAAc,IAAZM,CAAAA,QAAY,MAAZA,QAAY,CACzB,GAAMC,CAAAA,KAAK,CAAGV,eAAe,CAAC,OAAD,CAASS,QAAQ,CAACP,MAAlB,CAA7B,CACA,GAAMS,CAAAA,KAAK,CAAGX,eAAe,CAAC,OAAD,CAASS,QAAQ,CAACP,MAAlB,CAA7B,CACA,GAAMU,CAAAA,QAAQ,CAAGf,WAAW,EAA5B,CACA,GAAMgB,CAAAA,GAAG,CAAGC,OAAO,CAACC,GAAR,CAAYC,iBAAxB,CAEA,GAAGN,KAAH,CAAS,CACLO,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAoCR,KAApC,EACAf,KAAK,CAACwB,GAAN,WAAaN,GAAb,cAA4B,CACxBO,OAAO,CAAC,CACJC,aAAa,CAAC,UAAWJ,YAAY,CAACK,OAAb,CAAqB,aAArB,CADrB,CADgB,CAA5B,EAIGC,IAJH,CAIQ,SAAAC,IAAI,QAAEZ,CAAAA,QAAQ,CAACb,KAAK,CAACyB,IAAI,CAACC,IAAN,CAAN,CAAV,EAJZ,EAKA,mBAAO,oBAAC,QAAD,EAAU,EAAE,CAAE,CACjBC,QAAQ,CAAE,GADO,CAEjBC,KAAK,CAAE,CAAEC,IAAI,CAAEnB,QAAR,CAFU,CAAd,EAAP,CAIH,CAXD,IAWK,CACD,mBAAO,oBAAC,QAAD,EAAU,EAAE,CAAE,CACjBiB,QAAQ,CAAE,QADO,CAEjBC,KAAK,CAAE,CACHC,IAAI,CAAEnB,QADH,CAEHE,KAAK,CAAEA,KAFJ,CAFU,CAAd,EAAP,CAOH,CACJ,CA1BD","sourcesContent":["import axios from 'axios';\nimport React from 'react'\nimport { useDispatch } from 'react-redux';\nimport { Redirect } from 'react-router'\nimport { login } from 'webapp/_actions';\n\nconst getUrlParameter= (name,search) => {\n    name = name.replace(/[\\[]/, '\\\\[').replace(/[\\]]/, '\\\\]');\n    var regex = new RegExp('[\\\\?&]' + name + '=([^&#]*)');\n\n    var results = regex.exec(search);\n    return results === null ? '' : decodeURIComponent(results[1].replace(/\\+/g, ' '));\n}\n\nexport default ({location})=>{\n    const token = getUrlParameter('token',location.search);\n    const error = getUrlParameter('error',location.search);\n    const dispatch = useDispatch()\n    const URL = process.env.REACT_APP_API_URL\n\n    if(token){\n        localStorage.setItem('accessToken', token)\n        axios.get(`${URL}/user/one`,{\n            headers:{\n                Authorization:'Bearer '+ localStorage.getItem('accessToken')\n            }\n        }).then(resp=>dispatch(login(resp.data)))\n        return <Redirect to={{\n            pathname: \"/\",\n            state: { from: location }\n        }}/>\n    }else{\n        return <Redirect to={{\n            pathname: \"/login\",\n            state: { \n                from: location,\n                error: error \n            }\n        }}/>\n    }\n}"]},"metadata":{},"sourceType":"module"}